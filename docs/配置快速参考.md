# ⚡ 配置快速参考卡片

## 🚀 缓存配置快速参考

### 开发环境推荐配置
```bash
# 用户缓存 - 5分钟TTL
USER_CACHE_MAX_SIZE=100
USER_CACHE_TTL=300000

# 内容缓存 - 2分钟TTL  
CONTENT_CACHE_MAX_SIZE=200
CONTENT_CACHE_TTL=120000

# 统计缓存 - 30秒TTL
STATS_CACHE_MAX_SIZE=50
STATS_CACHE_TTL=30000

# 配置缓存 - 10分钟TTL
CONFIG_CACHE_MAX_SIZE=20
CONFIG_CACHE_TTL=600000

# 会话缓存 - 15分钟TTL
SESSION_CACHE_MAX_SIZE=50
SESSION_CACHE_TTL=900000

# API缓存 - 1分钟TTL
API_CACHE_MAX_SIZE=100
API_CACHE_TTL=60000
```

### 生产环境推荐配置
```bash
# 用户缓存 - 30分钟TTL
USER_CACHE_MAX_SIZE=1000
USER_CACHE_TTL=1800000

# 内容缓存 - 10分钟TTL
CONTENT_CACHE_MAX_SIZE=2000
CONTENT_CACHE_TTL=600000

# 统计缓存 - 2分钟TTL
STATS_CACHE_MAX_SIZE=500
STATS_CACHE_TTL=120000

# 配置缓存 - 1小时TTL
CONFIG_CACHE_MAX_SIZE=200
CONFIG_CACHE_TTL=3600000

# 会话缓存 - 15分钟TTL
SESSION_CACHE_MAX_SIZE=500
SESSION_CACHE_TTL=900000

# API缓存 - 5分钟TTL
API_CACHE_MAX_SIZE=1000
API_CACHE_TTL=300000
```

## 🔧 环境切换快速命令

### 切换到生产环境
```bash
# 修改 .env 文件
NODE_ENV=production
LOG_LEVEL=info
DEBUG=false
CACHE_MONITOR_VERBOSE=false

# 重启服务
npm run build
npm start
```

### 切换到开发环境
```bash
# 修改 .env 文件
NODE_ENV=development
LOG_LEVEL=debug
DEBUG=true
CACHE_MONITOR_VERBOSE=true

# 重启服务
npm run dev
```

## 📊 性能指标参考

### 缓存命中率目标
- **优秀**: 90%+
- **良好**: 80-89%
- **一般**: 70-79%
- **需要优化**: <70%

### 响应时间目标
- **缓存命中**: <50ms
- **缓存未命中**: <200ms
- **数据库查询**: <500ms

### 内存使用参考
- **开发环境**: 100-500MB
- **生产环境**: 500MB-2GB
- **缓存占用**: 总内存的20-40%

## 🛡️ 安全配置检查清单

### 生产环境必须检查
- [ ] 更换 `JWT_SECRET`
- [ ] 更换 `SESSION_SECRET`
- [ ] 限制 `CORS_ORIGIN`
- [ ] 设置合理的速率限制
- [ ] 禁用调试模式
- [ ] 设置日志级别为 `info`

### 密钥强度要求
- **JWT_SECRET**: 至少32位随机字符串
- **SESSION_SECRET**: 至少32位随机字符串
- **避免使用**: 常见词汇、日期、简单字符串

## 🔍 故障排查快速指南

### 缓存不工作
```bash
# 检查配置
CACHE_ENABLED=true

# 检查环境变量
NODE_ENV=development

# 查看日志
LOG_LEVEL=debug
```

### 内存占用过高
```bash
# 减少缓存大小
USER_CACHE_MAX_SIZE=100
CONTENT_CACHE_MAX_SIZE=200

# 缩短TTL
USER_CACHE_TTL=300000
CONTENT_CACHE_TTL=120000
```

### 响应速度慢
```bash
# 增加缓存大小
USER_CACHE_MAX_SIZE=500
CONTENT_CACHE_MAX_SIZE=1000

# 延长TTL
USER_CACHE_TTL=1800000
CONTENT_CACHE_TTL=600000
```

## 📱 常用配置组合

### 高性能配置
```bash
NODE_ENV=production
CACHE_ENABLED=true
USER_CACHE_MAX_SIZE=2000
CONTENT_CACHE_MAX_SIZE=5000
USER_CACHE_TTL=3600000        # 1小时
CONTENT_CACHE_TTL=1800000     # 30分钟
```

### 内存优化配置
```bash
NODE_ENV=production
CACHE_ENABLED=true
USER_CACHE_MAX_SIZE=500
CONTENT_CACHE_MAX_SIZE=1000
USER_CACHE_TTL=900000         # 15分钟
CONTENT_CACHE_TTL=600000      # 10分钟
```

### 开发调试配置
```bash
NODE_ENV=development
LOG_LEVEL=debug
DEBUG=true
CACHE_MONITOR_VERBOSE=true
CACHE_INVALIDATION_TEST_ENABLED=true
```

## 🎯 配置优先级说明

### 配置加载顺序
1. **系统环境变量** (最高优先级)
2. **.env 文件**
3. **默认配置**
4. **代码硬编码** (最低优先级)

### 缓存配置优先级
1. **环境变量配置** (如: `USER_CACHE_TTL`)
2. **NODE_ENV 环境配置**
3. **代码默认值**

## 📝 配置修改注意事项

### 需要重启的配置
- `NODE_ENV`
- `PORT`
- 所有缓存大小和TTL配置
- 安全相关配置

### 支持热重载的配置
- `LOG_LEVEL`
- `CACHE_MONITOR_VERBOSE`
- `DEBUG`

### 配置验证命令
```bash
# 检查配置加载
npm run dev

# 查看缓存状态
# 访问管理后台缓存面板

# 测试缓存功能
# 使用缓存测试页面
```
