# BiuBiuStar 站点设置使用指南

## 概述

站点设置系统已经完全实现，支持在管理后台配置站点名称、描述、Logo和图标，这些设置会实时应用到前台显示。

## 功能特性

### ✅ 已实现的功能

1. **站点基础信息配置**
   - 站点名称：显示在网站标题和导航栏
   - 站点描述：网站的详细描述信息
   - 站点Logo：显示在导航栏的品牌标识
   - 站点图标：浏览器标签页显示的favicon

2. **文件上传功能**
   - 支持图片文件上传（JPG、PNG、GIF、SVG）
   - 自动转换为Base64格式存储
   - 文件大小限制：5MB
   - 实时预览功能

3. **前台实时更新**
   - 设置保存后立即生效
   - 导航栏Logo和名称自动更新
   - 浏览器图标动态切换
   - 页面标题同步更新

4. **数据持久化**
   - 设置保存到数据库system_settings表
   - 支持公开设置API供前台调用
   - 缓存机制优化性能

## 使用说明

### 管理后台配置

1. **登录管理后台**
   ```
   访问：http://your-domain/admin
   使用管理员账号登录
   ```

2. **进入系统设置**
   ```
   侧边栏 → 系统设置 → 基础设置
   ```

3. **配置站点信息**
   - **站点名称**：输入您的网站名称（如：MyWebsite）
   - **站点描述**：输入网站描述（支持多行文本）
   - **站点Logo**：
     - 点击"上传标志"按钮选择图片文件
     - 推荐尺寸：200x200像素
     - 支持格式：PNG、JPG、SVG
   - **站点图标**：
     - 点击"上传图标"按钮选择图标文件
     - 推荐尺寸：32x32像素
     - 支持格式：ICO、PNG

4. **保存设置**
   - 配置完成后点击"保存设置"按钮
   - 系统会显示保存成功的提示
   - 设置立即生效

### 前台效果验证

配置完成后，可以在以下地方看到效果：

1. **导航栏**
   - 左上角显示站点Logo（如果上传）
   - 站点名称显示在Logo旁边

2. **浏览器标签页**
   - 显示自定义的站点图标
   - 页面标题包含站点名称

3. **移动端适配**
   - 响应式设计，在移动设备上正常显示

## 技术实现

### 数据库结构

```sql
-- system_settings表结构
- setting_key: 设置键名（如：site_name, site_logo）
- setting_value: 设置值
- setting_type: 数据类型（string, boolean, number, json）
- category: 分类（basic, user, email等）
- is_public: 是否公开（前台可访问）
```

### API接口

1. **获取公开设置**
   ```http
   GET /api/admin/settings/public
   ```

2. **获取管理员设置**
   ```http
   GET /api/admin/settings
   Authorization: Bearer {token}
   ```

3. **保存设置**
   ```http
   PUT /api/admin/settings
   Authorization: Bearer {token}
   Content-Type: application/json
   
   {
     "basic.siteName": "新站点名称",
     "basic.siteDescription": "新描述",
     "basic.siteLogo": "data:image/png;base64,...",
     "basic.siteFavicon": "data:image/png;base64,..."
   }
   ```

### 前端组件

1. **管理后台组件**
   - `BasicSettings.tsx`：基础设置表单
   - `useSystemSettings.ts`：设置管理Hook

2. **前台组件**
   - `Navbar.tsx`：导航栏（显示Logo和名称）
   - `useSettings.ts`：前台设置Hook
   - `useFavicon.ts`：动态favicon更新

## 测试工具

项目根目录提供了测试页面：`test-site-settings.html`

### 使用测试页面

1. **启动项目**
   ```bash
   npm run dev  # 启动前端
   npm run server  # 启动后端API
   ```

2. **访问测试页面**
   ```
   http://localhost:5173/test-site-settings.html
   ```

3. **测试步骤**
   - 点击"获取公开设置"查看当前配置
   - 修改表单中的值
   - 点击"保存设置"（需要先在管理后台登录）
   - 点击"打开前台首页"验证效果

## 故障排除

### 常见问题

1. **设置无法保存**
   - 检查是否已登录管理后台
   - 确认网络连接正常
   - 查看浏览器控制台错误信息

2. **Logo不显示**
   - 检查图片文件格式是否支持
   - 确认文件大小不超过5MB
   - 查看图片URL是否正确

3. **前台未更新**
   - 清除浏览器缓存
   - 检查API返回的数据格式
   - 确认设置已正确保存到数据库

### 调试方法

1. **查看API响应**
   ```javascript
   fetch('/api/admin/settings/public')
     .then(response => response.json())
     .then(console.log)
   ```

2. **检查数据库**
   ```sql
   SELECT * FROM system_settings WHERE category = 'basic';
   ```

3. **查看浏览器控制台**
   - 打开开发者工具
   - 查看Console选项卡的错误信息
   - 检查Network选项卡的API调用

## 扩展开发

### 添加新的设置项

1. **数据库添加设置**
   ```sql
   INSERT INTO system_settings (setting_key, setting_value, setting_type, category, description, is_public) 
   VALUES ('new_setting', 'default_value', 'string', 'basic', '新设置描述', true);
   ```

2. **前端添加表单字段**
   在`BasicSettings.tsx`中添加新的输入字段

3. **更新类型定义**
   在相关的TypeScript接口中添加新字段

### 性能优化建议

1. **图片优化**
   - 建议使用CDN存储大图片
   - 考虑实现文件上传到云存储服务

2. **缓存优化**
   - 前端设置了5分钟缓存
   - 可根据需要调整缓存策略

3. **数据库优化**
   - 已创建相关索引
   - 定期清理无效设置

## 更新日志

### v1.0.0 (当前版本)
- ✅ 实现基础设置功能
- ✅ 支持文件上传
- ✅ 前台实时更新
- ✅ 数据持久化
- ✅ 测试工具完备

---

## 联系支持

如有问题或建议，请联系开发团队。
